#include <AccelStepper.h>
AccelStepper stepper(8, 8, 9, 10, 11);
unsigned long time_m1=0;
//Variable f√ºr Zustandswechsel
int taster_state_before = 0;
// Kugeltaster
const int taster = 5;
int taster_state = 0;
//Millisekunden Motorlaufzeit je Tasterdruck
unsigned long time_per_taster=1000;
//Pruefvariable
int zaehler = 0;

void setup() {
  Serial.begin(9600);
  stepper.setMaxSpeed(900);
  stepper.setAcceleration(1000);
  //Taster Pin
  pinMode(taster, INPUT_PULLUP); //bei INPUT muss der pin auf GND
}

void loop() {
//Mit Zeitsteuerung
//Wenn Taster gedrueckt wird, wird die Motorlaufzeit erhoeht
  if(digitalRead(taster)==1){
    taster_state=0;
    }
 if(digitalRead(taster)==0){
    taster_state=1;
    }

if(taster_state==1){
  if(taster_state_before==0){
  zaehler=zaehler+1;

  if(time_m1 <= millis()){
    time_m1=millis()+time_per_taster;
  }
  if(time_m1>millis()){
    time_m1=time_m1+time_per_taster;
  }

  taster_state_before=1; //damit nur einmal pro tasterdruck Zeit erhoeht wird
  Serial.print(" Zaehler: ");
  Serial.print(zaehler);
  Serial.print(" timer: ");
  Serial.print(time_m1);
  }
}
if(taster_state_before==1){
if(taster_state==0){
  taster_state_before=0;
  delay(20);      //enprellen des tasters
}
}
if(time_m1 > millis()){
 stepper.setSpeed(700);
 stepper.runSpeed(); 
}
}
